-- ==================== ФУНКЦИЯ ЗАГРУЗОЧНОГО ЭКРАНА ====================
local function createLoader()
    local Players = game:GetService("Players")
    local TweenService = game:GetService("TweenService")
    local RunService = game:GetService("RunService")

    local SETTINGS = {
        loadTime = 15,
        titleText = "Amethyst Hub",
        logoAsset = "rbxassetid://99419671323896",
        barColor = Color3.fromRGB(150, 0, 255),
    }

    local statusMessages = {
        {text = "Defining the game", endTime = 5},
        {text = "Looking for a script", endTime = 10},
        {text = "Loading the script", endTime = 15}
    }

    local scriptConfig = {
        [142823291] = [[loadstring(game:HttpGet(""))()]],
    }

    local player = Players.LocalPlayer
    
    local gui = Instance.new("ScreenGui")
    gui.Name = "AmethystLoader"
    gui.IgnoreGuiInset = true
    gui.ResetOnSpawn = false
    gui.Parent = player:WaitForChild("PlayerGui")

    local mainFrame = Instance.new("Frame", gui)
    mainFrame.Size = UDim2.new(1, 0, 1, 0)
    mainFrame.BackgroundColor3 = Color3.fromRGB(5, 5, 5)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0

    local titleLabel = Instance.new("TextLabel", mainFrame)
    titleLabel.Size = UDim2.new(0, 500, 0, 80)
    titleLabel.Position = UDim2.new(0.5, 0, 0.35, 0)
    titleLabel.AnchorPoint = Vector2.new(0.5, 0.5)
    titleLabel.Text = SETTINGS.titleText
    titleLabel.Font = Enum.Font.LuckiestGuy
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextSize = 60
    titleLabel.BackgroundTransparency = 1

    local titleGradient = Instance.new("UIGradient", titleLabel)
    titleGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 0, 180)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(200, 140, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(100, 0, 180))
    })

    local logoImage = Instance.new("ImageLabel", mainFrame)
    logoImage.Size = UDim2.new(0, 120, 0, 120)
    logoImage.Position = UDim2.new(0.5, 0, 0.55, 0)
    logoImage.AnchorPoint = Vector2.new(0.5, 0.5)
    logoImage.BackgroundTransparency = 1 
    logoImage.Image = SETTINGS.logoAsset
    logoImage.ScaleType = Enum.ScaleType.Fit

    local barBackground = Instance.new("Frame", mainFrame)
    barBackground.Size = UDim2.new(0, 400, 0, 12)
    barBackground.Position = UDim2.new(0.5, 0, 0.8, 0)
    barBackground.AnchorPoint = Vector2.new(0.5, 0.5)
    barBackground.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    Instance.new("UICorner", barBackground).CornerRadius = UDim.new(0, 8)

    local barStroke = Instance.new("UIStroke", barBackground)
    barStroke.Color = Color3.fromRGB(200, 200, 200)
    barStroke.Thickness = 1.2
    barStroke.Transparency = 0.6

    local progressBar = Instance.new("Frame", barBackground)
    progressBar.Size = UDim2.new(0, 0, 1, 0)
    progressBar.BackgroundColor3 = SETTINGS.barColor
    Instance.new("UICorner", progressBar).CornerRadius = UDim.new(0, 8)

    local percentLabel = Instance.new("TextLabel", mainFrame)
    percentLabel.Position = UDim2.new(0.5, 0, 0.84, 0)
    percentLabel.AnchorPoint = Vector2.new(0.5, 0.5)
    percentLabel.Text = "0%"
    percentLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    percentLabel.Font = Enum.Font.Code
    percentLabel.TextSize = 14
    percentLabel.BackgroundTransparency = 1

    local statusLabel = Instance.new("TextLabel", mainFrame)
    statusLabel.Size = UDim2.new(0, 400, 0, 20)
    statusLabel.Position = UDim2.new(0.5, 0, 0.88, 0)
    statusLabel.AnchorPoint = Vector2.new(0.5, 0)
    statusLabel.Text = "Initializing..."
    statusLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
    statusLabel.Font = Enum.Font.SourceSans
    statusLabel.TextSize = 15
    statusLabel.BackgroundTransparency = 1

    local startTime = tick()
    RunService.Heartbeat:Connect(function()
        local elapsed = tick() - startTime
        local progress = math.min(elapsed / SETTINGS.loadTime, 1)
        
        progressBar.Size = UDim2.new(progress, 0, 1, 0)
        percentLabel.Text = math.floor(progress * 100) .. "%"

        for _, msg in ipairs(statusMessages) do
            if elapsed <= msg.endTime then
                statusLabel.Text = msg.text
                break
            end
        end

        if progress >= 1 then
            local finalScript = scriptConfig[game.PlaceId]
            if finalScript then 
                loadstring(finalScript)()
            end
            
            local tInfo = TweenInfo.new(1, Enum.EasingStyle.Linear)
            for _, obj in pairs(mainFrame:GetDescendants()) do
                if obj:IsA("TextLabel") then TweenService:Create(obj, tInfo, {TextTransparency = 1}):Play()
                elseif obj:IsA("ImageLabel") then TweenService:Create(obj, tInfo, {ImageTransparency = 1}):Play()
                elseif obj:IsA("Frame") then TweenService:Create(obj, tInfo, {BackgroundTransparency = 1}):Play()
                elseif obj:IsA("UIStroke") then TweenService:Create(obj, tInfo, {Transparency = 1}):Play() end
            end
            local finalTween = TweenService:Create(mainFrame, tInfo, {BackgroundTransparency = 1})
            finalTween:Play()
            finalTween.Completed:Connect(function() 
                gui:Destroy()
            end)
        end
    end)
end

createLoader()
